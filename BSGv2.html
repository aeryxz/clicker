<!DOCTYPE html>
<html>
<head>

<script>
	//resources
	var bullshit = 0;
	var code = 0;
	var money = 20000;
	var maintenance = 0;
	var numberOfProduct = [{"name":"test1","capital":0,"incomeRate":0,"maintenanceCost":0}]; //numberOfProduct[0]

	//resource generators
	var productManager = 0;
	var developer = 0;
	var productRate = 0.05;
	var developerRate = 0.10;

	//cost of next resource
	var productManagerCost = (productManager+1)*1.5;
	var developerCost = (developer+1)*2;
	var ideaCost = 5;
	var incomeFromProducts = 0;
	var finishedProductCost = 5;

	//
	var developerUnlocked = false;
	var productUnlocked = false;
	var canReleaseProduct = false;
	var hasProduct = false;
	var creatingProduct = false;

	//stop timer if player loses
	var timer = 1000;

	function printEconomy() {
		updateEconomy();
		updateVisibilityButtons(); //show/hide buttons depending on boolean status
		if (developerUnlocked == false) {
			document.getElementById('playerEconomy').innerHTML = "<b>Economy</b></br>Lines of Bullshit: " + bullshit +"</br></p>";
			document.getElementById('playerGenerators').innerHTML = "<b>Eric GmbH</b></br>Money:  " + money + "</br>Product Managers: " + productManager +" </br></br>Wages Cost: " + maintenance + "</br>";
			document.getElementById('employeeCostStatus').innerHTML = "Next PM costs: " + productManagerCost +" monies.</br>";
		}
		else {
			document.getElementById('playerEconomy').innerHTML = "<b>Economy</b></br>Lines of Bullshit: " + bullshit +"</br>Lines of Code: " + code +"</p>";
			document.getElementById('playerGenerators').innerHTML = "<b>Eric GmbH</b></br>Money:  " + money + "</br>Product Managers: " + productManager +" </br>Developers: " + developer + "</br></br>Wages Cost: " + maintenance + "</br>";
			document.getElementById('employeeCostStatus').innerHTML = "Next PM costs: " + productManagerCost +"</br>Next Dev costs: " + developerCost +" bullshit.</br>";
		}

		if (hasProduct == true) {
			document.getElementById('productListing').innerHTML = "show products here"; //list array
		}
	}

	function updateEconomy() {
		//update costs
		productManagerCost = (productManager+1)*1.5;
		developerCost = (developer+1)*2;
		//update economy
		bullshit += productManager*productRate;
		code += developer*developerRate;
		maintenance = (productManager*1.5) + (developer*3);
		money -= maintenance;

		if (money < 0) {
			alert("You LOSE!");
			timer = 0;
		}
	}
	function updateVisibilityButtons() {
		if (developerUnlocked == true) {
			document.getElementById('buyDevBtn').style.visibility = 'visible';
			document.getElementById('sellDevBtn').style.visibility = 'visible';
		}
		//able to start production on product
		if (creatingProduct == false && bullshit > ideaCost) {
			document.getElementById('startProductBtn').style.visibility = 'visible';
		}
		else {
			document.getElementById('startProductBtn').style.visibility = 'hidden';
		}
		//show creating product feedback
		if (creatingProduct == true){
				document.getElementById('productStatus').innerHTML = "Your next product can be released with the next " + finishedProductCost + " lines of code.";
		}
		else {
			document.getElementById('productStatus').innerHTML = "";
		}

		//release product
		if (creatingProduct == true && code > finishedProductCost) {
			document.getElementById('relProductBtn').style.visibility = 'visible';
		}
		else {
			document.getElementById('relProductBtn').style.visibility = 'hidden';
		}
		//able to remove last product
		if (hasProduct == true) {
			document.getElementById('canProductBtn').style.visibility = 'visible';
		}

	}

	function buyProductManager(){
		if (money > productManagerCost) {
			money -= productManagerCost;
			productManager++;
		}
	}

	function sellProductManager() {
		if (productManager > 0) {
			productManager--;
		}
	}

	function buyDeveloper(){
		if (bullshit > developerCost) {
			bullshit -= developerCost;
			developer++;
		}
	}

	function sellDeveloper() {
		if (developer > 0) {
			developer--;
		}
	}

	function releaseProduct() {
		if (code > finishedProductCost) {
			code -= finishedProductCost;
			var i = numberOfProduct.length;
			numberOfProduct[i] = {"name":"test"+i,"capital":(Math.floor(Math.random()*10)+1),"incomeRate":(Math.floor(Math.random()*5)+1),"maintenanceCost":(Math.floor(Math.random()*10)+1)} //1-10
			creatingProduct = false;
			hasProduct = true;
			alert(numberOfProduct);
			finishedProductCost += 5;
		}
	}

	function cancelProduct() {
		//you should be able to cancel any product you want, for prototype just remove last product
		if (numberOfProduct > 0) {
			var i = numberOfProduct.length-1;
			numberOfProduct = numberOfProduct.splice(i,1);
			alert(numberOfProduct);
			finishedProductCost -= 5;
		}	
	}

	function createProduct() {
		developerUnlocked = true;
		bullshit -= ideaCost;
		ideaCost += 5;
		creatingProduct = true;
	}

	//once idea has been chosen, unlock new resource generator -> developer. Dev makes new source: lines of code
	//lines of code used to complete ideas
	//completed ideas give randomised bonus to money and incomeProducts but then increase maintenance cost
	//after first product, unlock maintenance tech tree (outsourcing)
	//buying more outsource costs money but reduces maintenance
	//if product is a successful one when income products > maintenance cost

	//future: ABTest product -> randomise incomeProduct, randomise maintenance cost
	//product + developer cap -> increase building size to increase population
</script>

</head>
<body>
<p id="playerEconomy"><b>Economy</b></br>
Lines of Bullshit: 0  </br>
</p>

<p id="playerGenerators"><b>Eric GmbH</b> </br>
Money: 0 </br>
Product Managers: 0  </br>
Wages Cost: 0 </br>
</p>

<button type="button" onclick="buyProductManager()">+1 PM</button>
<button type="button" onclick="sellProductManager()">-1 PM</button>
<button type="button" id="buyDevBtn" onclick="buyDeveloper()" style="visibility:hidden">+1 DEV</button>
<button type="button" id="sellDevBtn"onclick="sellDeveloper()" style="visibility:hidden">-1 DEV</button>
<p>
<button type="button" id="startProductBtn"onclick="createProduct()" style="visibility:hidden">Create F2P game</button>
<button type="button" id="relProductBtn"onclick="releaseProduct()" style="visibility:hidden">Release F2P game</button>
<button type="button" id="canProductBtn"onclick="cancelProduct()" style="visibility:hidden">Cancel F2P game</button>
<script>
	setInterval(printEconomy,timer);
</script>
<p id="employeeCostStatus">
<p id="productStatus">
<p id="productListing">

</body>
</html>
